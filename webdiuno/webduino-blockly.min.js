! function(e) { "undefined" == typeof exports ? e(window) : module.exports = e }(function(e) { "use strict"; var t = [],
        n = void 0,
        i = function() {},
        f = function() {},
        o = "",
        r = e.speechSynthesis;

    function a(e, i) { var f, o, r, a; return e.transport && (f = e, a = Object.keys(f), t.some(function(e) { return (r = !a.some(function(t) { return f[t] !== e._options[t] })) && (o = e), r }), e = o), e ? e.getPin(i) : n }

    function c() { document.removeEventListener("click", c), DeviceOrientationEvent.requestPermission().then(t => { "granted" === t && e.addEventListener("deviceorientation", i) }).catch(permissionState.error) }

    function u() { e.removeEventListener("deviceorientation", i) }

    function s() { document.removeEventListener("click", s), DeviceMotionEvent.requestPermission().then(t => { "granted" === t && e.addEventListener("devicemotion", f) }).catch(permissionState.error) }

    function d() { e.removeEventListener("devicemotion", f) }

    function l(e, t, n, i, f) { this._rS = a(e, t), this._rS.setMode(3), this._rD = a(e, n), this._rD.setMode(1), this._lD = a(e, i), this._lD.setMode(1), this._lS = a(e, f), this._lS.setMode(3), this._speedL = 1, this._speedR = 1, this._dirL = 1, this._dirR = 1 } l.prototype.setRightSpeed = function(e) { this._speedR = e / 100 }, l.prototype.setLeftSpeed = function(e) { this._speedL = e / 100 }, l.prototype.motor = function(e, t, n, i) { var f = parseFloat(1 == e ? n : 1 - n),
            o = parseFloat(0 == t ? i : 1 - i);
        this._rS.write(f), this._rD.write(1 - e), this._lD.write(t), this._lS.write(o) }, l.prototype.goFront = function() { this.motor(1, 1, parseFloat(this._speedR), parseFloat(this._speedL)) }, l.prototype.goBack = function() { this.motor(0, 0, parseFloat(this._speedR), parseFloat(this._speedL)) }, l.prototype.goRight = function() { this.motor(1, 1, 0, parseFloat(this._speedL)) }, l.prototype.goLeft = function() { this.motor(1, 1, parseFloat(this._speedR), 0) }, l.prototype.turnRight = function() { this.motor(0, 1, parseFloat(this._speedR), parseFloat(this._speedL)) }, l.prototype.turnLeft = function() { this.motor(1, 0, parseFloat(this._speedR), parseFloat(this._speedL)) }, l.prototype.backLeft = function() { this.motor(1, 0, 0, parseFloat(this._speedL)) }, l.prototype.backRight = function() { this.motor(0, 1, parseFloat(this._speedR), 0) }, l.prototype.stop = function() { this.motor(1, 1, 0, 0) }, l.prototype.onlyLeftFront = function() { this._lS.write(1 - this._speedL), this._lD.write(this._dirL) }, l.prototype.onlyRightFront = function() { this._rS.write(this._speedR), this._rD.write(1 - this._dirR) }, l.prototype.onlyLeftBack = function() { this._lS.write(this._speedL), this._lD.write(1 - this._dirL) }, l.prototype.onlyRightBack = function() { this._rS.write(1 - this._speedR), this._rD.write(this._dirR) }, l.prototype.onlyLeftStop = function() { this._lS.write(0), this._lD.write(0) }, l.prototype.onlyRightStop = function() { this._rS.write(0), this._rD.write(0) }, e.boardReady = function e(n, i, f) { f = "function" == typeof i ? i : f; var o = t.length,
            r = (c = n, "string" == typeof c && (c = { device: c }), c.board ? new webduino.board[c.board](c) : c.device || c.url ? new webduino.WebArduino(c) : new webduino.Arduino(c)),
            a = function() { r = null, delete t[o], t.splice(o, 1), !0 === i && setTimeout(function() { e(n, i, f) }, 5e3) }; var c;
        r.once(webduino.BoardEvent.ERROR, function() { r.isConnected ? (r.once(webduino.BoardEvent.DISCONNECT, a), r.disconnect()) : a() }), r.once(webduino.BoardEvent.READY, f), t.push(r) }, e.getPin = a, e.getLed = function(e, t) { return new webduino.module.Led(e, e.getDigitalPin(t)) }, e.getRelay = function(e, t) { return new webduino.module.Relay(e, e.getDigitalPin(t)) }, e.getRGBLed = function(e, t, n, i) { return new webduino.module.RGBLed(e, e.getDigitalPin(t), e.getDigitalPin(n), e.getDigitalPin(i)) }, e.getRGBLedCathode = function(e, t, n, i) { return new webduino.module.RGBLed(e, e.getDigitalPin(t), e.getDigitalPin(n), e.getDigitalPin(i), webduino.module.RGBLed.COMMON_CATHODE) }, e.getUltrasonic = function(e, t, n) { return new webduino.module.Ultrasonic(e, e.getDigitalPin(t), e.getDigitalPin(n)) }, e.getButton = function(e, t) { return new webduino.module.Button(e, e.getDigitalPin(t)) }, e.getPullupButton = function(e, t) { return new webduino.module.Button(e, e.getDigitalPin(t), webduino.module.Button.PULL_UP) }, e.getPir = function(e, t) { return new webduino.module.Pir(e, e.getDigitalPin(t)) }, e.getSound = function(e, t) { return new webduino.module.Sound(e, e.getDigitalPin(t)) }, e.getShock = function(e, t) { return new webduino.module.Shock(e, e.getDigitalPin(t)) }, e.getDht = function(e, t) { return new webduino.module.Dht(e, e.getDigitalPin(t)) }, e.getG3 = function(e, t, n) { return new webduino.module.G3(e, e.getDigitalPin(t), e.getDigitalPin(n)) }, e.getBuzzer = function(e, t) { return new webduino.module.Buzzer(e, e.getDigitalPin(t)) }, e.getServo = function(e, t) { return new webduino.module.Servo(e, e.getDigitalPin(t)) }, e.dhtAreaChart = function() { google.load("visualization", "1", { packages: ["corechart"], callback: function() {} }) }, e.delay = function(e) { return new Promise(function(t) { setTimeout(function() { t() }, 1e3 * e) }) }, e.getMax7219 = function(e, t, n, i) { return new webduino.module.Max7219(e, e.getDigitalPin(t), e.getDigitalPin(n), e.getDigitalPin(i)) }, e.getPhotocell = function(e, t) { return new webduino.module.Photocell(e, t) }, e.getSoil = function(e, t, n) { return webduino.module.Soil.prototype._type = n, webduino.module.Soil.prototype.detect = function(t) { this._board.enableAnalogPin(this._pinNumber), "function" != typeof t && (t = function() {}), this._callback = function(n) { var i = 0;
                console.log(n), "Smart" == e._options.board ? 1 == this._type ? i = (n = 100 - n) < 92.93 ? 0 : n > 94.91 ? 100 : Math.round(100 / 1.98 * (n - 92.93)) : 0 == this._type && (i = n) : 1 == this._type ? i = (n = 100 - n) < 15 ? 0 : n > 54 ? 100 : Math.round(2.5 * (n - 15)) : 0 == this._type && (i = n), t(i) }, this._state = "on", this._board.on(webduino.BoardEvent.ANALOG_DATA, this._messageHandler), this.addListener("message", this._callback) }, new webduino.module.Soil(e, t) }, e.getIRRecv = function(e, t) { return new webduino.module.IRRecv(e, e.getDigitalPin(t)) }, e.getIRLed = function(e, t) { return new webduino.module.IRLed(e, t) }, e.getADXL345 = function(e) { return new webduino.module.ADXL345(e) }, e.getHX711 = function(e, t, n) { return new webduino.module.HX711(e, t, n) }, e.getDataTransfer = function(e) { return new webduino.module.DataTransfer(e) }, e.getSSD1306 = function(e) { return new webduino.module.SSD1306(e) }, e.getBarcode = function(e, t, n) { return new webduino.module.Barcode(e, t, n) }, e.getJoystick = function(e, t, n, i) { return new webduino.module.Joystick(e, t, n, e.getDigitalPin(i)) }, e.getRFID = function(e) { return new webduino.module.RFID(e) }, e.getToyCar = function(e, t, n, i, f) { return new l(e, t, n, i, f) }, e.setDeviceOrientationListener = function(t) { u(), "function" == typeof t && (i = function(n) { var i, f, o;
            n.webkitCompassHeading ? i = n.webkitCompassHeading : (i = n.alpha, e.chrome || (i -= 270)), f = n.beta, o = n.gamma, t.apply(this, [i, f, o]) }), "function" == typeof DeviceOrientationEvent.requestPermission ? document.addEventListener("click", c) : e.addEventListener("deviceorientation", i) }, e.removeDeviceOrientationListener = u, e.setDeviceMotionListener = function(t) { d(), "function" == typeof t && (f = function(e) { var n, i, f;
            n = e.acceleration.x, i = e.acceleration.y, f = e.acceleration.z, t.apply(this, [n, i, f]) }), "function" == typeof DeviceMotionEvent.requestPermission ? document.addEventListener("click", s) : e.addEventListener("devicemotion", f) }, e.removeDeviceMotionListener = d, e.konami = function(e, t) { var n = "38384040373937396665";
        (o += e).length > n.length && (o = o.replace(o.slice(0, 2), "")), console.log(o), "function" == typeof t && o == n && t() }, e.speak = function(e, t, n, i) { if (r.cancel(), !r.speaking) { var f = new SpeechSynthesisUtterance(e); "function" == typeof t && (n = t, t = ["zh-TW", 1, 1, 1]), t || (t = ["zh-TW", 1, 1, 1]), f.lang = t[0] || "zh-TW", f.volume = t[1] || 1, f.pitch = t[2] || 1, f.rate = t[3] || 1, r.speak(f), "function" == typeof n && (0 == i ? f.onend = function() { n() } : f.onstart = function() { n() }) } window.addEventListener("unload", function() { r.cancel() }) }, e.speakSynth = r, e.max7219_horse = function(e, t) { var n, i, f = t.split(""),
            o = []; if (t.length < 16)
            for (i = 0; i < 16 - t.length; i++) t += "0"; if ("left" == e)
            for (i = 0; i < t.length / 2; i++) n = f.splice(0, 2), f.push(n[0], n[1]), o[i] = f.join(""), o[i] = o[i].split("").splice(0, 16).join("");
        else
            for (i = 0; i < t.length / 2; i++) n = f.splice(t.length - 2, t.length), f.unshift(n[0], n[1]), o[i] = f.join(""), o[i] = o[i].split("").splice(0, 16).join(""); return o }, e.max7219_alphabet = function(e) { var t, n = { A: "00fc262226fc", a: "00f08888f880", B: "00fe929292fc", b: "00fe9090f0", C: "007cc6828282", c: "00f0909090", D: "00fe8282c67c", d: "00f09090fe", E: "00fe92929292", e: "00f8a8a8a8b8", F: "00fe12121202", f: "000008fe0a", G: "00fe829292f2", g: "0000bca4a4fc", H: "00fe101010fe", h: "00fe1010f0", I: "008282fe8282", i: "00f4", J: "00828282fe02", j: "000080f4", K: "00fe10284482", k: "00fe205088", L: "00fe80808080", l: "000000fe", M: "00fe02fc02fe", m: "00f010f010f0", N: "00fe0c30c0fe", n: "00f01010f0", O: "007cc682c67c", o: "00f09090f0", P: "00fe2222223e", p: "00fc24243c", Q: "007cc6a246bc", q: "003c2424fc80", R: "00fe2262e2be", r: "00f02010", S: "009e929292f2", s: "00b8a8a8e8", T: "000202fe0202", t: "0004fe84", U: "00fe808080fe", u: "00f08080f0", V: "003e60c0603e", v: "00708070", W: "00fe80fe80fe", w: "00f080f080f0", X: "00c66c106cc6", x: "008850205088", Y: "000e18f0180e", y: "00b8a0a0f8", Z: "00c2a2928a86", z: "00c8a8a898", 0: "00fe8282fe", 1: "0082fe80", 2: "00f292929e", 3: "00929292fe", 4: "001e1010fe", 5: "009e9292f2", 6: "00fe9292f2", 7: "00020202fe", 8: "00fe9292fe", 9: "009e9292fe", ":": "0028", ";": "008068", ".": "0080", ",": "008060", "-": "00101010", _: "00808080", "~": "00201010202010", '"': "000600060", "+": "0010107c1010", "/": "0080601804", "?": "000601b10906", $: "005c54fe5474", "%": "00089468102c5220", "!": "00be", "<": "00102844", ">": "00442810", "(": "003c42", ")": "00423c", "[": "007e42", "]": "00427e", "*": "004830fc3048", "=": "00282828", "#": "00287c287c28", "@": "003844baaaba6458", " ": "00" },
            i = ""; if (e.length > 1)
            for (t = 0; t < e.length; t++) i += n[e[t]];
        else i = n[e]; var f = i.length; if (f < 16)
            for (t = 0; t < 16 - f; t++) i += "0"; return i }, e.max7219_number = function(e) { return { 0: "0000fe8282fe0000", 1: "00000082fe800000", 2: "0000f292929e0000", 3: "0000929292fe0000", 4: "00001e1010fe0000", 5: "00009e9292f20000", 6: "0000fe9292f20000", 7: "0000020202fe0000", 8: "0000fe9292fe0000", 9: "00009e9292fe0000", 10: "82fe8000fe82fe00", 11: "82fe800082fe8000", 12: "82fe8000f2929e00", 13: "82fe80009292fe00", 14: "82fe80001e10fe00", 15: "82fe80009e92f200", 16: "82fe8000fe92f200", 17: "82fe80000202fe00", 18: "82fe8000fe92fe00", 19: "82fe80009e92fe00", 20: "f2929e00fe82fe00", 21: "f2929e0082fe8000", 22: "f2929e00f2929e00", 23: "f2929e009292fe00", 24: "f2929e001e10fe00", 25: "f2929e009e92f200", 26: "f2929e00fe92f200", 27: "f2929e000202fe00", 28: "f2929e00fe92fe00", 29: "f2929e009e92fe00", 30: "9292fe00fe82fe00", 31: "9292fe0082fe8000", 32: "9292fe00f2929e00", 33: "9292fe009292fe00", 34: "9292fe001e10fe00", 35: "9292fe009e92f200", 36: "9292fe00fe92f200", 37: "9292fe000202fe00", 38: "9292fe00fe92fe00", 39: "9292fe009e92fe00", 40: "1e10fe00fe82fe00", 41: "1e10fe0082fe8000", 42: "1e10fe00f2929e00", 43: "1e10fe009292fe00", 44: "1e10fe001e10fe00", 45: "1e10fe009e92f200", 46: "1e10fe00fe92f200", 47: "1e10fe000202fe00", 48: "1e10fe00fe92fe00", 49: "1e10fe009e92fe00", 50: "9e92f200fe82fe00", 51: "9e92f20082fe8000", 52: "9e92f200f2929e00", 53: "9e92f2009292fe00", 54: "9e92f2001e10fe00", 55: "9e92f2009e92f200", 56: "9e92f200fe92f200", 57: "9e92f2000202fe00", 58: "9e92f200fe92fe00", 59: "9e92f2009e92fe00", 60: "fe92f200fe82fe00", 61: "fe92f20082fe8000", 62: "fe92f200f2929e00", 63: "fe92f2009292fe00", 64: "fe92f2001e10fe00", 65: "fe92f2009e92f200", 66: "fe92f200fe92f200", 67: "fe92f2000202fe00", 68: "fe92f200fe92fe00", 69: "fe92f2009e92fe00", 70: "0202fe00fe82fe00", 71: "0202fe0082fe8000", 72: "0202fe00f2929e00", 73: "0202fe009292fe00", 74: "0202fe001e10fe00", 75: "0202fe009e92f200", 76: "0202fe00fe92f200", 77: "0202fe000202fe00", 78: "0202fe00fe92fe00", 79: "0202fe009e92fe00", 80: "fe92fe00fe82fe00", 81: "fe92fe0082fe8000", 82: "fe92fe00f2929e00", 83: "fe92fe009292fe00", 84: "fe92fe001e10fe00", 85: "fe92fe009e92f200", 86: "fe92fe00fe92f200", 87: "fe92fe000202fe00", 88: "fe92fe00fe92fe00", 89: "fe92fe009e92fe00", 90: "9e92fe00fe82fe00", 91: "9e92fe0082fe8000", 92: "9e92fe00f2929e00", 93: "9e92fe009292fe00", 94: "9e92fe001e10fe00", 95: "9e92fe009e92f200", 96: "9e92fe00fe92f200", 97: "9e92fe000202fe00", 98: "9e92fe00fe92fe00", 99: "9e92fe009e92fe00" } [e] }, e.writeSheetData = function(e) { var t; return function(e) { let t, n = 0,
                i = 0; if (Array.isArray(e.data)) { for (let t in e.data) Array.isArray(e.data[t]) && (n += 1, i = e.data[t].length);
                t = e.data.join() } else t = e.data; let f = { sheetUrl: e.sheetUrl, sheetName: e.sheetName, type: e.type, data: t, range: e.range, arrayRow: n, arrayColumn: i }; return fetch("https://script.google.com/macros/s/AKfycbwBLLmy6R9TIQrzRmoJer7HVn1MXn20vfZ9d3WE9NY3LcIkm37j/exec", { method: "post", body: encodeURIComponent(JSON.stringify(f)), headers: { "Content-Type": "application/x-www-form-urlencoded; charset=utf-8" } }).then(e => e.text()).then(e => { console.log(e) }).catch(e => { console.error("[sheetWriteData__] error catch:", e) }) }((t = e, { type: "last", data: Object.keys(t).filter(e => /^column\w+$/.test(e)).map(e => t[e]), range: "auto", sheetUrl: t.sheetUrl, sheetName: t.sheetName })) }, e.readSheetData = function(e, t) { $.get("https://script.google.com/macros/s/AKfycbxJjv240G64yTmUyIzkCKi9r7Jux2c1YvEsaDWS-eawMjQz-nQ/exec", e, function(e) { t(e) }) }, e.getYoutubeVideoId = function(e) { var t; return -1 != (e = e.replace(/'/g, "")).indexOf("?v=") ? -1 != (t = e.split("?v="))[1].indexOf("&") ? t[1].split("&")[0] : t[1] : e }, e.boards = t });